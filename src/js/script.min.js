document.addEventListener("DOMContentLoaded",(function(){const e={recipeContainer:document.getElementById("recipe-container"),coffeeAmount:document.getElementById("coffee-amount"),waterAmount:document.getElementById("water-amount"),ratio:document.getElementById("ratio"),recipeCoffee:document.getElementById("recipe-coffee"),recipeWater:document.getElementById("recipe-water"),recipeRatio:document.getElementById("recipe-ratio"),recipeSteps:document.getElementById("recipe-steps"),timerDisplay:document.querySelector(".timer-display"),startBtn:document.getElementById("timer-start"),resetBtn:document.getElementById("timer-reset"),progressBar:document.querySelector(".timer-progress-bar"),currentStep:document.querySelector(".current-step"),nextStep:document.querySelector(".next-step"),recipeDetails:document.querySelector(".recipe-details"),recipeInfo:document.querySelector(".recipe-info"),timestampsContainer:document.getElementById("timer-timestamps")},t=15,o=15,n=225,a=300,s=3,r=100,i=45,c={interval:null,startTime:null,isRunning:!1,elapsedPausedTime:0,recipeSteps:[],countdownActive:!1,countdownValue:s,hasStarted:!1,updateInterval:null};let d=!1;function l(e,t){let o;return function(...n){clearTimeout(o),o=setTimeout((()=>e.apply(this,n)),t)}}
const u=function(){let e=null;function t(){if(!e)try{const t=window.AudioContext||window.webkitAudioContext;e=new t}catch(e){}}
function o(o=800,n=100,a=.5){return{play:function(){if(e||(t(),e))try{function s(){const t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.type="sine",t.frequency.value=o,s.gain.value=a,t.start(),s.gain.setValueAtTime(a,e.currentTime),s.gain.exponentialRampToValueAtTime(.001,e.currentTime+n/1e3),setTimeout((()=>{try{t.stop(),t.disconnect(),s.disconnect()}catch(e){console.log("Erro ao parar oscilador:",e)}}),n)}
"suspended"===e.state?e.resume().then((()=>{s()})).catch((e=>{})):s()}catch(r){}else{}}}}
function n(e){const t=document.createElement("audio");return t.src="assets/audio/beep.mp3",t.preload="auto",t.volume=e?.3:.5,{play:function(){try{const e=t.cloneNode();e.play().catch((e=>{})),e.onended=function(){document.body.contains(e)&&document.body.removeChild(e)},e.style.display="none",document.body.appendChild(e)}catch(e){}}}}
return document.addEventListener("click",(function e(){t(),document.removeEventListener("click",e)}),{once:!0}),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?{countdownBeep:n(!0),startBeep:n(!1),completionBeep:function(){return{play:function(){const frequencies=[523,659,784,1047];frequencies.forEach((freq,index)=>{setTimeout(()=>{if(e||(t(),e))try{const oscillator=e.createOscillator();const gainNode=e.createGain();oscillator.connect(gainNode);gainNode.connect(e.destination);oscillator.type="sine";oscillator.frequency.value=freq;gainNode.gain.value=0.4;oscillator.start();gainNode.gain.setValueAtTime(0.4,e.currentTime);gainNode.gain.exponentialRampToValueAtTime(0.001,e.currentTime+0.3);setTimeout(()=>{try{oscillator.stop();oscillator.disconnect();gainNode.disconnect()}catch(err){}},300)}catch(err){}},index*150)})}}}()}:{countdownBeep:o(800,100,.3),startBeep:o(1200,200,.5),completionBeep:function(){return{play:function(){const frequencies=[440,554,659,880];frequencies.forEach((freq,index)=>{setTimeout(()=>{if(e||(t(),e))try{const oscillator=e.createOscillator();const gainNode=e.createGain();oscillator.connect(gainNode);gainNode.connect(e.destination);oscillator.type="triangle";oscillator.frequency.value=freq;gainNode.gain.value=0.3;oscillator.start();gainNode.gain.setValueAtTime(0.3,e.currentTime);gainNode.gain.exponentialRampToValueAtTime(0.001,e.currentTime+0.4);setTimeout(()=>{try{oscillator.stop();oscillator.disconnect();gainNode.disconnect()}catch(err){}},400)}catch(err){}},index*200)})}}}()}}();function p(){if(d)return;d=!0;const n=(parseInt(e.coffeeAmount.value)||t)*(parseInt(e.ratio.value)||o);e.waterAmount.value=n,d=!1,y()}
function m(){if(d)return;d=!0;const t=parseInt(e.waterAmount.value)||n,a=parseInt(e.ratio.value)||o,s=Math.round(t/a);e.coffeeAmount.value=s,d=!1,y()}
function f(){if(d)return;d=!0;const n=parseInt(e.ratio.value)||o,a=(parseInt(e.coffeeAmount.value)||t)*n;e.waterAmount.value=a,d=!1,y()}
function g(){const t=e.recipeDetails,o=e.recipeSteps;if(t&&o){t.style.height="auto";const n=o.scrollHeight,a=e.recipeInfo.offsetHeight,s=n+a+20;t.style.height=`${s}px`}}
function y(){const s=parseInt(e.coffeeAmount.value)||t,r=parseInt(e.waterAmount.value)||n,c=parseInt(e.ratio.value)||o,d=document.querySelector(".preference-card[data-flavor].selected").dataset.flavor,l=document.querySelector(".preference-card[data-body].selected").dataset.body,u=Math.round(r/5);let p=Array(5).fill(u);if("acidic"===d?(p[0]=Math.round(1.2*u),p[1]=Math.round(.8*u)):"sweet"===d&&(p[0]=Math.round(.8*u),p[1]=Math.round(1.2*u)),"light"===l){const e=p[2]+p[3]+p[4];p[2]=Math.round(.5*e),p[3]=Math.round(.5*e),p[4]=0,p=p.filter((e=>e>0))}else if("full"===l){const e=p[2]+p[3]+p[4],t=Math.round(e/4);p[2]=t,p[3]=t,p[4]=t,p.push(t)}
const m=r-p.reduce(((e,t)=>e+t),0);0!==m&&p.length>0&&(p[p.length-1]+=m),e.recipeCoffee.textContent=`${s}g`,e.recipeWater.textContent=`${r}ml`,e.recipeRatio.textContent=`1:${c}`,e.recipeSteps.innerHTML="";const f=v(1,`Pese <strong>${s}g</strong> de caf√© mo√≠do no m√©dio-grosso/grosso.`);e.recipeSteps.appendChild(f);const y=v(2,"Coloque o filtro na v60 e enx√°gue com √°gua quente para remover o gosto de papel e pr√©-aquecer. Acrescente o caf√©.");e.recipeSteps.appendChild(y);let h=0,b=3;const S=["00:00","00:45","01:30","02:15","03:00","03:45"];p.forEach(((t,o)=>{h+=t;const n=v(b++,`Em <strong>${S[o]}</strong>, despeje <strong>${t}ml</strong> de √°gua (total: <strong>${h}ml</strong>).`);e.recipeSteps.appendChild(n)}));const w=p.length-1,x=S[w]||"00:00",[E,L]=x.split(":"),C=60*parseInt(E)+parseInt(L)+i,q=`${Math.floor(C/60)}:${(C%60).toString().padStart(2,"0")}`,A=v(b,`O tempo total de extra√ß√£o deve ser aproximadamente <strong>${q}</strong>. Bom caf√©! ‚òï`);e.recipeSteps.appendChild(A),e.recipeContainer.style.display="flex",g(),setTimeout(g,a),setTimeout(g,2*a)}
function v(e,t){const o=document.createElement("div");o.className="step";const n=document.createElement("div");n.className="step-number",n.textContent=e;const a=document.createElement("div");return a.className="step-text",a.innerHTML=t,o.appendChild(n),o.appendChild(a),o}
function h(){if(window.innerWidth<=768){const e=document.querySelector(".timer-section");e&&setTimeout((()=>{const t=e.getBoundingClientRect(),o=window.pageYOffset||document.documentElement.scrollTop,n=t.top+o;window.scrollTo({top:n-60,behavior:"smooth"}),setTimeout((()=>{const t=e.getBoundingClientRect();if(t.top<0||t.top>60){const e=(window.pageYOffset||document.documentElement.scrollTop)+t.top-60;window.scrollTo({top:e,behavior:"smooth"})}}),500)}),100)}}
function b(){if(c.isRunning)pauseTimer();else if(c.hasStarted)c.elapsedPausedTime>0&&(c.startTime=Date.now()-c.elapsedPausedTime,c.isRunning=!0,e.startBtn.textContent="Pausar",e.startBtn.classList.add("pause"),c.interval=setInterval(S,r));else{if(c.hasStarted=!0,c.startTime=Date.now(),c.elapsedPausedTime=0,c.isRunning=!0,e.progressBar.style.display="block",e.timestampsContainer.style.display="block",e.startBtn.textContent="Pausar",e.startBtn.classList.add("pause"),function(){document.querySelectorAll(".preference-card").forEach((e=>{e.classList.add("disabled"),e.style.pointerEvents="none",e.style.opacity="0.6"})),document.getElementById("coffee-amount").disabled=!0,document.getElementById("water-amount").disabled=!0,document.getElementById("ratio").disabled=!0;document.querySelectorAll(".lock-button").forEach((e=>{e.disabled=!0,e.style.opacity="0.6"}))}(),document.getElementById("recipe-container").classList.add("highlighted"),function(){c.recipeSteps=[];const t=[0,45,90,135,180,225],o=Array.from(document.querySelectorAll(".step-text")).filter((e=>e.innerHTML.includes("despeje")||e.innerHTML.includes("Despeje")));let n=0;for(let e=0;e<Math.min(o.length,t.length);e++){const a=o[e].innerHTML.match(/despeje\s+<strong>(\d+)ml<\/strong>/i);if(a&&a[1]){const o=parseInt(a[1]);n+=o,c.recipeSteps.push({time:t[e],text:`Despeje ${o}ml de √°gua (Total: ${n}ml)`})}}
let a=255;const s=document.querySelectorAll(".step-text"),r=s[s.length-1];if(r){const e=r.innerHTML.match(/aproximadamente\s+<strong>([0-9]+):([0-9]+)<\/strong>/);if(e&&void 0!==e[1]&&void 0!==e[2]){const t=parseInt(e[1]),o=parseInt(e[2]);a=60*t+o}}
c.recipeSteps.push({time:a,text:`Caf√© pronto! ‚òï (Total: ${n}ml)`}),function(t){const o=e.timestampsContainer;o.innerHTML="";c.recipeSteps.map((e=>e.time)).forEach((e=>{const n=e/t*100,a=`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,s=document.createElement("div");s.className="timestamp",s.style.left=`${n}%`,s.textContent=a,o.appendChild(s)}))}(a)}(),w(0),c.recipeSteps.length>0)
if(e.currentStep.textContent=c.recipeSteps[0].text,c.recipeSteps.length>1){const t=c.recipeSteps[1].time;e.nextStep.textContent=`Pr√≥ximo em ${t}s: ${c.recipeSteps[1].text}`}else e.nextStep.textContent="";c.interval=setInterval(S,r)}}
function S(){const t=Date.now()-c.startTime,o=Math.floor(t/1e3),n=o%60,a=`${Math.floor(o/60).toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`;e.timerDisplay.textContent!==a&&(e.timerDisplay.textContent=a,e.timerDisplay.classList.add("timer-update"),setTimeout((()=>{e.timerDisplay.classList.remove("timer-update")}),200));const totalExtractionTime=c.recipeSteps.length>0?c.recipeSteps[c.recipeSteps.length-1].time:255;if(o>=totalExtractionTime&&c.isRunning){clearInterval(c.interval);c.isRunning=!1;e.startBtn.textContent="Conclu√≠do";e.startBtn.classList.remove("pause");e.startBtn.disabled=!0;e.startBtn.style.backgroundColor="#4CAF50";e.startBtn.style.cursor="not-allowed";if(u&&u.completionBeep){u.completionBeep.play()}else if(u&&u.startBeep){u.startBeep.play();setTimeout(()=>u.startBeep.play(),200);setTimeout(()=>u.startBeep.play(),400)}
e.currentStep.textContent="‚úÖ Extra√ß√£o conclu√≠da! Seu caf√© est√° pronto! ‚òï";e.nextStep.textContent="";e.timerDisplay.classList.add("timer-completed");return}(function(t){const o=c.recipeSteps.length>0?c.recipeSteps[c.recipeSteps.length-1].time:255,n=Math.min(t/o*100,100);if(e.progressBar.style.width=`${n}%`,c.recipeSteps.length>0){let o=0,n=1;for(let e=0;e<c.recipeSteps.length&&t>=c.recipeSteps[e].time;e++)o=e,n=e+1;const a=c.recipeSteps[o].text,s=e.currentStep;if(s.textContent!==a&&(s.textContent=a,s.classList.add("step-changed"),setTimeout((()=>{s.classList.remove("step-changed")}),1500),w(o)),n<c.recipeSteps.length){const o=c.recipeSteps[n].time-t;e.nextStep.textContent=`Pr√≥ximo em ${o}s: ${c.recipeSteps[n].text}`}else e.nextStep.textContent="√öltimo passo"}})(o)}
function w(e){document.querySelectorAll(".step-text").forEach((e=>{e.classList.remove("current-recipe-step")}));const t=document.querySelectorAll(".step-text");let o=-1;if(0===e){for(let e=0;e<t.length;e++)
if(t[e].innerHTML.includes("Em <strong>00:00</strong>")||t[e].textContent.includes("Em 00:00")&&t[e].textContent.includes("despeje")){o=e;break}}else if(e===c.recipeSteps.length-1)o=t.length-1;else{const n=["00:00","00:45","01:30","02:15","03:00","03:45"][e]||"00:00";for(let e=0;e<t.length;e++)
if(t[e].innerHTML.includes(`Em <strong>${n}</strong>`)){o=e;break}}
if(-1===o&&e>0)
for(let n=0;n<t.length&&(!t[n].textContent.includes("despeje")||(o=n,e!==c.recipeSteps.length-2));n++);if(o>=0&&o<t.length){const e=t[o];e.style.animation="none",e.offsetWidth,e.style.animation="",e.style.opacity="1",e.classList.add("current-recipe-step"),e.scrollIntoView({behavior:"smooth",block:"nearest"})}}
window.addEventListener("resize",g);const x=new MutationObserver((function(e){g()}));e.recipeSteps&&x.observe(e.recipeSteps,{childList:!0,subtree:!0,characterData:!0}),function(){const e=document.createElement("style");e.textContent="\n            .step-text {\n                transition: opacity 0.3s ease, transform 0.3s ease, background-color 0.3s ease;\n            }\n\n            .step-text.current-recipe-step {\n                animation: stepHighlight 1.5s ease;\n                animation-fill-mode: forwards;\n            }\n\n            @keyframes stepEnter {\n                from {\n                    opacity: 0;\n                    transform: translateX(-10px);\n                }\n                to {\n                    opacity: 1;\n                    transform: translateX(5px);\n                }\n            }\n        ",document.head.appendChild(e)}(),document.body.classList.add("dark-mode"),localStorage.setItem("darkMode","true"),document.querySelectorAll(".preference-card").forEach((e=>{e.addEventListener("click",(function(){const t=void 0!==e.dataset.flavor?"[data-flavor]":"[data-body]";document.querySelectorAll(t).forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected"),y()}))})),e.coffeeAmount.addEventListener("input",p),e.waterAmount.addEventListener("input",m),e.ratio.addEventListener("input",f),function(){const t=document.getElementById("water-lock"),o=document.getElementById("ratio-lock");t&&t.addEventListener("click",(function(){const t=e.waterAmount.parentElement.parentElement;t.classList.contains("disabled")?(e.waterAmount.disabled=!1,t.classList.remove("disabled"),this.textContent="üîì",this.title="Bloquear campo"):(e.waterAmount.disabled=!0,t.classList.add("disabled"),this.textContent="üîí",this.title="Desbloquear campo")})),o&&o.addEventListener("click",(function(){const t=e.ratio.parentElement.parentElement;t.classList.contains("disabled")?(e.ratio.disabled=!1,t.classList.remove("disabled"),this.textContent="üîì",this.title="Bloquear campo"):(e.ratio.disabled=!0,t.classList.add("disabled"),this.textContent="üîí",this.title="Desbloquear campo")}))}(),function(){const t=e.startBtn,o=e.resetBtn;function n(){c.countdownActive=!0,c.countdownValue=s,e.timerDisplay.textContent=c.countdownValue.toString(),u.countdownBeep.play();const t=setInterval((()=>{c.countdownValue--,c.countdownValue>0?(e.timerDisplay.textContent=c.countdownValue.toString(),u.countdownBeep.play()):(clearInterval(t),c.countdownActive=!1,b(),u.startBeep.play(),h())}),1e3)}
t.addEventListener("click",(function(){if(!c.countdownActive)
if(c.isRunning)clearInterval(c.interval),c.elapsedPausedTime=Date.now()-c.startTime,c.isRunning=!1,t.textContent="Continuar",t.classList.remove("pause");else if(null!==c.startTime&&c.elapsedPausedTime>0)c.startTime=Date.now()-c.elapsedPausedTime,c.isRunning=!0,t.textContent="Pausar",t.classList.add("pause"),c.interval=setInterval(S,r);else if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){u.startBeep.play(),c.countdownActive=!0,c.countdownValue=s,e.timerDisplay.textContent=c.countdownValue.toString();const t=setInterval((()=>{c.countdownValue--,c.countdownValue>0?e.timerDisplay.textContent=c.countdownValue.toString():(clearInterval(t),c.countdownActive=!1,b(),h())}),1e3)}else n()})),o.addEventListener("click",(function(){clearInterval(c.interval),e.timerDisplay.textContent="00:00",t.textContent="Iniciar",t.classList.remove("pause"),t.disabled=!1,e.progressBar.style.width="0%",e.progressBar.style.display="none",e.timestampsContainer.style.display="none",e.currentStep.textContent="Pronto para come√ßar",e.nextStep.textContent="",c.isRunning=!1,c.countdownActive=!1,c.startTime=null,c.elapsedPausedTime=0,c.hasStarted=!1,e.timerDisplay.classList.remove("timer-completed"),t.style.backgroundColor="",t.style.cursor="",document.querySelectorAll(".preference-card").forEach((e=>{e.classList.remove("disabled"),e.style.pointerEvents="auto",e.style.opacity="1"})),document.getElementById("coffee-amount").disabled=!1,document.querySelectorAll(".lock-button").forEach((e=>{e.disabled=!1,e.style.opacity="1"})),document.getElementById("recipe-container").classList.remove("highlighted"),document.querySelectorAll(".step-text").forEach((e=>{e.classList.remove("current-recipe-step")}))}))}(),function(){if(window.ResizeObserver){const t=new ResizeObserver(l((()=>{g()}),100));e.recipeContainer&&t.observe(e.recipeContainer)}else window.addEventListener("resize",l(g,100))}(),function(){const e=document.createElement("button");e.className="dark-mode-toggle",e.setAttribute("aria-label","Alternar modo escuro"),document.body.appendChild(e),e.addEventListener("click",(()=>{document.body.classList.contains("dark-mode")&&document.body.classList.add("mode-transition"),document.body.classList.toggle("dark-mode"),document.documentElement.classList.toggle("dark-theme");const e=document.body.classList.contains("dark-mode");localStorage.setItem("darkMode",e),e||setTimeout((()=>{document.body.classList.remove("mode-transition")}),500)}))}(),function(){const e=document.querySelector(".method-explanation-btn");e&&e.addEventListener("click",(function(){!function(){const e='\n            <div class="tetsu-photo-container">\n                <picture>\n                    <source srcset="assets/images/webp/tetsu-kasuya.webp" type="image/webp">\n                    <img src="assets/images/tetsu-kasuya.jpg" alt="Tetsu Kasuya" class="tetsu-photo">\n                </picture>\n            </div>\n\n            <h3>Tetsu Kasuya</h3>\n            <p>Barista japon√™s, campe√£o mundial de Brewers Cup em 2016. Criou o m√©todo 4:6, uma t√©cnica que permite controlar precisamente o sabor do caf√© dividindo a √°gua em ataques estrat√©gicos.</p>\n\n            <h4>Por que "4:6"?</h4>\n            <p>O nome se refere √† divis√£o da √°gua utilizada na receita: <strong>40%</strong> controlam o sabor <em>(acidez e do√ßura)</em> e <strong>60%</strong> controlam o corpo do caf√©.</p>\n\n            <div class="ratio-visualization">\n                <div class="ratio-part-4">40% Sabor</div>\n                <div class="ratio-part-6">60% Corpo</div>\n            </div>\n            <div class="ratio-labels">\n                <span>Primeiros 2 ataques</span>\n                <span>Ataques restantes</span>\n            </div>\n\n            <div class="ratio-buttons">\n                <div class="ratio-section">\n                    <div class="ratio-btn-group">\n                        <button class="ratio-btn ratio-balanced" data-type="balanced" data-category="reset">Padr√£o</button>\n                        <button class="ratio-btn ratio-acidic" data-type="acidic" data-category="flavor">Mais √°cido</button>\n                        <button class="ratio-btn ratio-sweet" data-type="sweet" data-category="flavor">Mais doce</button>\n                    </div>\n                </div>\n                <div class="ratio-section">\n                    <div class="ratio-btn-group">\n                        <button class="ratio-btn ratio-full" data-type="full" data-category="body">Mais corpo</button>\n                        <button class="ratio-btn ratio-light" data-type="light" data-category="body">Menos corpo</button>\n                    </div>\n                </div>\n            </div>\n        ';document.body.classList.add("modal-open");const t=document.createElement("div");t.className="method-explanation-modal";const o=document.createElement("div");o.className="method-explanation-modal-content",o.innerHTML=e;const n=document.createElement("button");n.className="method-explanation-modal-close",n.innerHTML="&times;",n.addEventListener("click",(function(){document.body.removeChild(t),document.body.classList.remove("modal-open")})),o.prepend(n),t.appendChild(o),document.body.appendChild(t),function(e){const t=e.querySelectorAll(".ratio-btn"),o=e.querySelector(".ratio-part-4"),n=e.querySelector(".ratio-part-6"),a=e.querySelector(".ratio-labels"),s={flavor:null,body:null},r={balanced:{firstPour:20,secondPour:20,desc:"Ataques iguais para acidez e do√ßura balanceadas"},acidic:{firstPour:24,secondPour:16,desc:"Primeiro ataque maior que o segundo, destacando as notas √°cidas"},sweet:{firstPour:16,secondPour:24,desc:"Segundo ataque maior que o primeiro, real√ßando a do√ßura"},default:{firstPour:20,secondPour:20,desc:"Ataques iguais (configura√ß√£o padr√£o)"}},i={standard:{bodySplit:3,desc:"Tr√™s ataques iguais para corpo moderado"},full:{bodySplit:4,desc:"Quatro ataques menores para maior corpo"},light:{bodySplit:2,desc:"Apenas dois ataques para corpo mais leve"},default:{bodySplit:3,desc:"Tr√™s ataques iguais (configura√ß√£o padr√£o)"}};function c(){t.forEach((e=>{"reset"!==e.getAttribute("data-category")&&e.classList.remove("active")})),s.flavor=null,s.body=null;const o=e.querySelector('.ratio-btn[data-category="reset"]');o&&o.classList.add("active"),d()}
function d(){const e=s.flavor?r[s.flavor]:r.default,t=s.body?i[s.body]:i.default,c=e.firstPour/(e.firstPour+e.secondPour);o.innerHTML=`<div style="width:${100*c}%; height:100%; display:flex; align-items:center; justify-content:center; background-color:rgba(var(--primary-rgb), 0.8);">${e.firstPour}%</div>\n            <div style="width:${100*(1-c)}%; height:100%; display:flex; align-items:center; justify-content:center;">${e.secondPour}%</div>`;let d="";const l=100/t.bodySplit,u=Math.round(60/t.bodySplit);for(let e=0;e<t.bodySplit;e++)d+=`<div style="width:${l}%; height:100%; display:flex; align-items:center; justify-content:center; background-color:rgba(var(--primary-rgb), ${.5+.5*e/t.bodySplit});">${u}%</div>`;if(n.innerHTML=d,!s.flavor&&!s.body)return void(a.innerHTML="<span>Primeiros 2 ataques</span><span>Ataques restantes</span>");let p="";p=2===t.bodySplit?"<span>Primeiros 2 ataques</span><span>Apenas 2 ataques finais</span>":4===t.bodySplit?"<span>Primeiros 2 ataques</span><span>4 ataques menores</span>":"<span>Primeiros 2 ataques</span><span>3 ataques finais</span>",a.innerHTML=p}
t.forEach((t=>{t.addEventListener("click",(function(){const t=this.getAttribute("data-type"),o=this.getAttribute("data-category");if(!t||!o)return;if("reset"===o)return void c();const n=e.querySelector('.ratio-btn[data-category="reset"]');n&&n.classList.remove("active"),e.querySelectorAll(`.ratio-btn[data-category="${o}"]`).forEach((e=>{e.classList.remove("active")})),this.classList.add("active"),"flavor"===o?s.flavor=t:"body"===o&&(s.body=t),d()}))})),c()}(t),t.addEventListener("click",(function(e){e.target===t&&(document.body.removeChild(t),document.body.classList.remove("modal-open"))}))}()}))}(),function(){if(!(window.innerWidth<=768))return;const e=document.querySelector(".kofi-button"),t=document.querySelector("footer");function o(){const o=t.getBoundingClientRect(),n=window.innerHeight;o.top<n?e.classList.add("bottom-page"):e.classList.remove("bottom-page")}
e&&t&&(o(),window.addEventListener("scroll",l(o,100)),window.addEventListener("resize",l((function(){window.innerWidth<=768?o():e.classList.remove("bottom-page")}),200)))}(),document.querySelector('[data-flavor="standard"]').classList.add("selected"),document.querySelector('[data-body="standard"]').classList.add("selected"),e.currentStep.textContent="Pronto para come√ßar",e.nextStep.textContent="",e.progressBar.style.display="none",e.timestampsContainer.style.display="none",y()}));(function(){const generalTips={title:"üí° Dicas para o melhor preparo",tips:["<strong>Equipamento:</strong> Ideal para Hario v60 ou m√©todos similares","<strong>Caf√©:</strong> Use gr√£os frescos mo√≠dos na hora, moagem m√©dia-grossa","<strong>√Ågua:</strong> 92-96¬∞C, utilize chaleira com bico de ganso para controle preciso do fluxo","<strong>Ataque:</strong> Movimentos circulares suaves, mantenha dist√¢ncia constante entre a chaleira e o caf√©","<strong>Tempo:</strong> Respeite os intervalos entre os ataques para extra√ß√£o ideal","<strong>Filtro:</strong> Pr√©-enx√°gue o filtro com √°gua quente para remover gosto de papel"]};function createRecipeTipsButton(){const button=document.createElement('button');button.className='recipe-tips-btn';const img=document.createElement('img');img.src='assets/images/webp/dica.webp';img.alt='√çcone de dica';img.className='recipe-tips-icon';button.appendChild(img);button.setAttribute('aria-label','Ver dicas gerais de preparo');button.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();showTipsModal()});return button}
function showTipsModal(){const modal=document.createElement('div');modal.className='tips-modal';const modalContent=document.createElement('div');modalContent.className='tips-modal-content';const closeBtn=document.createElement('button');closeBtn.className='tips-modal-close';closeBtn.innerHTML='√ó';closeBtn.addEventListener('click',closeTipsModal);const title=document.createElement('h3');title.textContent=generalTips.title;const tipsList=document.createElement('ul');generalTips.tips.forEach(tip=>{const li=document.createElement('li');li.innerHTML=tip;tipsList.appendChild(li)});modalContent.appendChild(closeBtn);modalContent.appendChild(title);modalContent.appendChild(tipsList);modal.appendChild(modalContent);document.body.appendChild(modal);document.body.classList.add('modal-open');modal.addEventListener('click',function(e){if(e.target===modal){closeTipsModal()}});document.addEventListener('keydown',handleEscapeKey)}
function closeTipsModal(){const modal=document.querySelector('.tips-modal');if(modal){document.body.removeChild(modal);document.body.classList.remove('modal-open');document.removeEventListener('keydown',handleEscapeKey)}}
function handleEscapeKey(e){if(e.key==='Escape'){closeTipsModal()}}
function addRecipeTipsButton(){const recipeContainer=document.getElementById('recipe-container');if(!recipeContainer)return;const heading=recipeContainer.querySelector('h3');if(!heading)return;if(heading.querySelector('.recipe-tips-btn'))return;const tipsButton=createRecipeTipsButton();heading.appendChild(tipsButton)}
const observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(mutation.type==='childList'||mutation.type==='attributes'){const isModalChange=Array.from(mutation.addedNodes).some(node=>node.nodeType===1&&(node.classList&&(node.classList.contains('tips-modal')||node.classList.contains('method-explanation-modal'))));if(!isModalChange){addRecipeTipsButton()}}})});document.addEventListener('DOMContentLoaded',function(){addRecipeTipsButton();observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0})});addRecipeTipsButton();setTimeout(addRecipeTipsButton,500);setTimeout(addRecipeTipsButton,2000);setTimeout(addRecipeTipsButton,5000)})()